df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[df$PTS > 20 & df$AST > 3 & df$REB > 5, ]
View(df5)
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df$PTS > 20) & (df$AST > 3) & (df$REB > 5), ]
View(df5)
# df3 <- df[!(df$COUNTRY == 'USA'), ]
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df$PTS > 6.36) & (df$AST > 1.44) & (df$REB > 2.98), ]
View(df5)
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
View(df5)
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=COLOUR)) +
geom_bar(alpha=0.8) + coord_flip() + scale_fill_identity()
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > 12, "star", "nonstar")
View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() + scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip()
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > 20, "star", "nonstar")
View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS < 20, "nonstar", "star")
View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
df5$star <- ifelse(df5$PTS < 20, "nonstar", "star")
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS < 20, "star", "nonstar")
View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip()
?ifesle
?ifelse
df5$star <- ifelse(df5$PTS < 20, "nonstar", "star")
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS < 20, "nonstar", "astar")
View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > 20, "nonstar", "astar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() + guides(fill = guide_legend(reverse = T))
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() + guides(fill = guide_legend(reverse = F))
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip()
quantile(df$PTS)
quantile(df$PTS, na.rm = TRUE)
IQR(df$PTS, na.rm = TRUE)
quantile(df$PTS, na.rm = TRUE)[4]
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4] + 1.5*IQR(vec, na.rm=TRUE)}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > treshold(PTS), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
m_bar(stat='summary', fun.y = mean)
# df3 <- df[!(df$COUNTRY == 'USA'), ]
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4] + 1.5*IQR(vec, na.rm=TRUE)}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > treshold(df5$PTS), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > treshold(df5$PTS), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > treshold(df5$PTS) & df5$AST > treshold(df5$AST), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > treshold(df5$PTS) & df5$AST > treshold(df5$AST) & df5$AST > treshold(df5$REB), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > treshold(df5$PTS) & df5$AST > treshold(df5$AST) & df5$REB > treshold(df5$REB), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
OUNTRY == 'USA'), ]
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[3]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df5$PTS > treshold(df5$PTS) & df5$AST > treshold(df5$AST) & df5$REB > treshold(df5$REB), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
quantile(df$PTS, na.rm = TRUE)
mean(df$PTS, na.rm = TRUE)
quantile(df5$PTS, na.rm = TRUE)
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df4$PTS > treshold(df4$PTS) & df5$AST > treshold(df4$AST) & df5$REB > treshold(df4$REB), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_iden
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse(df4$PTS > treshold(df4$PTS) & df4$AST > treshold(df4$AST) & df4$REB > treshold(df4$REB), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star)) +
geom_bar(alpha=0.8) + coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star), na.rm = TRUE) +
geom_bar(alpha=0.8, na.rm = TRUE) + coord_flip() #+ scale_fill_identity()
df3 <- df[!(df$COUNTRY == 'USA'), ]
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- complete.cases(df5)
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star), na.rm = TRUE) +
geom_bar(alpha=0.8, na.rm = TRUE) + coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=star), na.rm = TRUE) +
geom_bar(alpha=0.8, na.rm = TRUE) + coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM,TEAM,
function(x)+length(x)), fill=COLOUR, alpha=star), na.rm = TRUE) +
geom_bar(alpha=0.8, na.rm = TRUE) + coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "star", "nonstar")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(alpha=0.8, fill=star,na.rm = TRUE) +
coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=0.8, fill=star) ,na.rm = TRUE) +
coord_flip()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x)), fill=COLOUR), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x)), fill=COLOUR), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_color_discrete("#ffa200", "#007bff") +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x)), fill=COLOUR), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_color_discrete(c("#ffa200", "#007bff")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x)), fill=COLOUR), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_color_manual("#ffa200", "#007bff") +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
5)
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x)), fill=COLOUR), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_color_manual(c("#ffa200", "#007bff")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x)), fill=COLOUR), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_color_manual(values=c("#ffa200", "#007bff")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_color_manual(values=c("#ffa200", "#007bff")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_fill_manual(values=c("#ffa200", "#007bff")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), TeX("powyżej $Q_2$"), "powyżej Q")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_fill_manual(values=c("#ffa200", "#007bff")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej $Q_2$", "powyżej Q")
# View(df5)
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_fill_manual(values=c("#ffa200", "#007bff")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "#ffa200", "#007bff")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej Q3", "powyżej Q2")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_fill_manual(values=c("#ffa200", "#007bff")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "Drużyna aktywna", "Drużyna rozwiązana")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej Q3", "powyżej Q2")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_fill_manual(values=c("#ffa200", "#007bff")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$COLOUR <- ifelse(df4$TEAM %in% existing_teams, "Drużyna aktywna", "Drużyna rozwiązana")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej Q3", "powyżej Q2")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=COLOUR) ,na.rm = TRUE) +
scale_fill_manual(values=c("#007bff", "#ffa200")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
# geom_bar(stat='summary', fun.y = mean)
# df3 <- df[!(df$COUNTRY == 'USA'), ]
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$Status <- ifelse(df4$TEAM %in% existing_teams, "Drużyna aktywna", "Drużyna rozwiązana")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej Q3", "powyżej Q2")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=STATUS) ,na.rm = TRUE) +
scale_fill_manual(values=c("#007bff", "#ffa200")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$Status <- ifelse(df4$TEAM %in% existing_teams, "Drużyna aktywna", "Drużyna rozwiązana")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$star <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej Q3", "powyżej Q2")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=star, fill=Status) ,na.rm = TRUE) +
scale_fill_manual(values=c("#007bff", "#ffa200")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$Status <- ifelse(df4$TEAM %in% existing_teams, "Drużyna aktywna", "Drużyna rozwiązana")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$stats <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej Q3", "powyżej Q2")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=stats, fill=Status), na.rm = TRUE) +
scale_fill_manual(values=c("#007bff", "#ffa200")) +
scale_alpha_discrete(range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
treshold <- function(vec) {quantile(vec, na.rm = TRUE)[4]}
df4 <- df[!(df$TEAM == ''), ]
df4$Status <- ifelse(df4$TEAM %in% existing_teams, "Drużyna aktywna", "Drużyna rozwiązana")
df5 <- df4[(df4$PTS > 6.36) & (df4$AST > 1.44) & (df4$REB > 2.98), ]
df5 <- df5[complete.cases(df5), ]
df5$stats <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej Q3", "powyżej Q2")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=stats, fill=Status), na.rm = TRUE) +
scale_fill_manual(values=c("#007bff", "#ffa200")) +
scale_alpha_discrete("f", range=c(.5,1)) +
coord_flip() #+ scale_fill_identity()
df4 <- df[!(df$TEAM == ''), ]
df4$Status <- ifelse(df4$TEAM %in% existing_teams, "aktywna", "rozwiązana")
df5 <- df4[(df4$PTS > medPTS) & (df4$AST > medAST) & (df4$REB > medREB), ]
df5 <- df5[complete.cases(df5), ]
df5$stats <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej Q3", "powyżej Q2")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=stats, fill=Status), na.rm = TRUE) +
scale_fill_manual("Status drużyny", values=c("#007bff", "#ffa200")) +
scale_alpha_discrete("Punkty, asysty i zbiórki", range=c(.5,1)) +
labs(x = "Drużyna",
y = "Liczba zawodników",
title = "Liczba wyjątkowych zawodników w historii klubu") +
coord_flip() +
theme(text = element_text(size=10),
legend.position = c(0.7, 0.2),
legend.spacing.y = unit(1, "mm"),
panel.border = element_rect(colour = "black", fill=NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=alpha('white', 0.5)))
mean(df$PTS, na.rm = TRUE)
library(gridExtra)
library(gridExtra)
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=stats, fill=Status), na.rm = TRUE) +
annotation_custom(grob = textGrob("Extra text.  Read all about it"),
xmin = 2, xmax = 2, ymin = -4.5, ymax = -4.55) +
scale_fill_manual("Status drużyny", values=c("#007bff", "#ffa200")) +
scale_alpha_discrete("Punkty, asysty i zbiórki", range=c(.5,1)) +
labs(x = "Drużyna",
y = "Liczba zawodników",
title = "Liczba wyjątkowych zawodników w historii klubu") +
coord_flip() +
theme(text = element_text(size=10),
legend.position = c(0.7, 0.2),
legend.spacing.y = unit(1, "mm"),
panel.border = element_rect(colour = "black", fill=NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=alpha('white', 0.5)))
library(grid)
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=stats, fill=Status), na.rm = TRUE) +
annotation_custom(grob = textGrob("Extra text.  Read all about it"),
xmin = 2, xmax = 2, ymin = -4.5, ymax = -4.55) +
scale_fill_manual("Status drużyny", values=c("#007bff", "#ffa200")) +
scale_alpha_discrete("Punkty, asysty i zbiórki", range=c(.5,1)) +
labs(x = "Drużyna",
y = "Liczba zawodników",
title = "Liczba wyjątkowych zawodników w historii klubu") +
coord_flip() +
theme(text = element_text(size=10),
legend.position = c(0.7, 0.2),
legend.spacing.y = unit(1, "mm"),
panel.border = element_rect(colour = "black", fill=NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=alpha('white', 0.5)))
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=stats, fill=Status), na.rm = TRUE) +
scale_fill_manual("Status drużyny", values=c("#007bff", "#ffa200")) +
scale_alpha_discrete("Punkty, asysty i zbiórki", range=c(.5,1)) +
labs(x = "Drużyna",
y = "Liczba zawodników",
title = "Liczba wyjątkowych zawodników w historii klubu") +
coord_flip() +
theme(text = element_text(size=10),
legend.position = c(0.7, 0.2),
legend.spacing.y = unit(1, "mm"),
panel.border = element_rect(colour = "black", fill=NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=alpha('white', 0.5)))
#+ scale_fill_identity()
df5$stats <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej trzeciego kwartyla", "powyżej mediany")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=stats, fill=Status), na.rm = TRUE) +
scale_fill_manual("Status drużyny", values=c("#007bff", "#ffa200")) +
scale_alpha_discrete("Punkty, asysty i zbiórki", range=c(.5,1)) +
labs(x = "Drużyna",
y = "Liczba zawodników",
title = "Liczba wyjątkowych zawodników w historii klubu") +
coord_flip() +
theme(text = element_text(size=10),
legend.position = c(0.7, 0.2),
legend.spacing.y = unit(1, "mm"),
panel.border = element_rect(colour = "black", fill=NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=alpha('white', 0.5)))
#+ scale_fill_identity()
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=stats, fill=Status), na.rm = TRUE) +
scale_fill_manual("Status drużyny", values=c("#007bff", "#ffa200")) +
scale_alpha_discrete("Punkty, asysty i zbiórki", range=c(.5,1)) +
labs(x = "Drużyna",
y = "Liczba zawodników",
title = "Liczba wyjątkowych zawodników w historii klubu") +
coord_flip() +
theme(text = element_text(size=10),
legend.position = c(0.7, 0.2),
legend.spacing.y = unit(1, "mm"),
panel.border = element_rect(colour = "black", fill=NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=alpha('white', 0.5)))
df5$stats <- ifelse((df5$PTS > treshold(df4$PTS)) & (df5$AST > treshold(df4$AST)) & (df5$REB > treshold(df4$REB)), "powyżej Q3", "powyżej Q2")
ggplot(df5, aes(x=reorder(TEAM, TEAM, function(x)+length(x))), na.rm = TRUE) +
geom_bar(aes(alpha=stats, fill=Status), na.rm = TRUE) +
scale_fill_manual("Status drużyny", values=c("#007bff", "#ffa200")) +
scale_alpha_discrete("Punkty, asysty i zbiórki", range=c(.5,1)) +
labs(x = "Drużyna",
y = "Liczba zawodników",
title = "Liczba wyjątkowych zawodników w historii klubu") +
coord_flip() +
theme(text = element_text(size=10),
legend.position = c(0.7, 0.2),
legend.spacing.y = unit(1, "mm"),
panel.border = element_rect(colour = "black", fill=NA),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black", fill=alpha('white', 0.5)))
#+ scale_fill_identity()
